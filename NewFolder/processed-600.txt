 a permutation of length nn is an array of nn integers such that every integer between  and nn inclusive appears in it exactly once  chef creates a set from a permutation pp…pnpp…pn of length nn as follows  initially chef takes a empty set sϕsϕ and then for every index i≤i≤ni≤i≤n chef insert a pair of integers liriliri into ss where ≤li≤ri≤n≤li≤ri≤n and plipli…priplipli…pri denotes the longest subsegment of the permutation with pipi as the maximum element    note   the elements of the set ss are always distinct  two pairs liriliri and ljrjljrj are same only if liljlilj and rirjrirj   for example if the permutation is  chef creates the following set ss  you are given a set tt containing nn distinct pairs of integers  find the number of different permutations of length nn from which chef can create a set ss which is equivalent to set tt  since the number can be very large print it modulo    two sets ss and tt are considered equivalent if  ∣s∣∣t∣∣s∣∣t∣ where ∣s∣∣s∣ denotes the size of set ss  every element of ss is present in tt i e for each liri∈sliri∈tliri∈sliri∈t   note that the elements of the set tt may not be given in a particular order  input format  the first line of input contains an integer tt denoting the number of test cases  the tt test cases then follow the first line of each test case contains a single integer nn denoting the size of set tt  each of the next nn lines contains a pair of integers liriliri denoting the set tt   output format for each test case output on a single line the number of valid permutations modulo    constraints  ≤t≤≤t≤ ≤n≤⋅≤n≤⋅ ≤li≤ri≤n≤li≤ri≤n for each valid ii liri≠ljrjliri≠ljrj if i≠ji≠j sum of nn over all test cases does not exceed ⋅⋅                          sample input                                                                                            sample output                                explanation test case  there are two permutations of length    generates the set ss which is not equivalent to tt and  generates the set ss which is equivalent to tt  test case  there is no permutation of length  which can generate a set equivalent to tt  test case  some of the valid permutations are     etc  however  is not a valid permutation since it generates the set ss which is not equivalent to set tt   author ★soumyadeep editorial  codechef comproblemshidperm tags                                   binarysearch easymedium recursion soumyadeep start                                                                                        difficulty rating                        date added  time limit  secs source limit  bytes languages cpp pyth   java c cpp pyth pyp cs ada pypy text pas fpc nodejs ruby php go hask tcl kotlin perl scala lua bash js rust lisp sbcl pas gpc bf cloj r d caml swift fort asm fs wspc lisp clisp sql scm guile perl erl clps prlg sqlq ick nice icon cob scm chicken pike scm qobi st nem  submit