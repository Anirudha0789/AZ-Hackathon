  read problems statements in mandarin chinese russian and vietnamese as well  dreaming to manipulate the dimensions of spacetime one day chef satisfies himself with manipulating dimensions of abstract mathematical entities for now  today chef has n lists consisting of integers  the ith list is represented as li and has size si  chef has transformed the given lists of integers to form an n dimensional matrix m of size s × s × s × … × sn such that an entry j j j …  jn in the matrix m is obtained by taking product of given n integers lj lj lj     lnjn where liji denotes the jth integer in the ith list based indexing  to explore the mathematics of the matrix m deeply chef wants to compute the maximum submatrix sum in this matrix but he is afraid of its high dimensionality  so he asked you to help him  he asked you to compute two quantities the maximum submatrix sum in the matrix m and the number of submatrices having this maximum sum  since the second answer to this problem can be very large output it modulo    input  first line of input contains a single integer t denoting the number of test cases  first line of each test case contains a single integer n denoting the number of lists of integers  next n lines of each test case contains some space separated integers where integers in the ith line make up the ith list  each list description has the following format  t first integer si in the ith line denotes the size of the ith list and the next si space separated integers are the elements in the list  output for each test case output  space separated integers second integer modulo    where the first integer denotes the maximum submatrix sum and the second denotes the number of such submatrices   constraints   ≤ t ≤   ≤ n ≤   ≤ si ≤   ≤ lij ≤                          sample input                                                                      sample output                                explanation  all the matrices with maximum sum are highlighted with coloured fencing   author ★matermind tester ★antoniuk editorial  codechef comproblemsmxsm tags                                   bitmasking greedy adhoc                                                              mathematics bit manipulation algorithms constructive                                                                                        difficulty rating                        date added  time limit  secs source limit  bytes languages pyth   java c cpp pyth pyp cs ada pypy text pas fpc nodejs ruby php go hask tcl perl scala lua bash js lisp sbcl pas gpc bf cloj d caml fort asm fs wspc lisp clisp scm guile perl erl clps prlg ick nice icon scm chicken pike scm qobi st nem  submit