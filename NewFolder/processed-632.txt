  read problems statements in mandarin chinese russian and vietnamese as well  serega is an avid traveller  he has already visited numerous exotic places and now wants to embark on a journey to treeland  there are n cities in treeland that serega wants to visit  also roads have been laid between some n pairs of cities in treeland  roads are bidirectional and there exists a unique path between any two treeland cities   each of treelands roads has its own class wich is specified using a single digit  seregas journey is a path between some cities i e  he never visits one city more than once  but serega wants to select a path such that the sequence of classes on the path is a palindrome  of course serega wants to visit as many cities as possible  please help him   input the first line of input contains a single integer t denoting the number of test cases  the description of t test cases follows  the first line of each case contains a single integer n  the next n lines contain the roads  each line contains three integers v u and c meaning that there is a road of class c between the vth and uth assuming indexing cities of treeland  output for each test case you should output the maximum number of cities that serega can visit  constraints   ≤ t ≤   ≤ n ≤  sum of n over all test cases in a single file will not be greater then   ≤ c ≤   ≤ u v ≤ n the roads form a tree   subtasks  subtask   points  ≤ n ≤   subtask   points  ≤ n ≤                               sample input                                                                            sample output                             explanation sequence of classes on the path between the cities  and  is    author ★gomelfk tester ★xcwgf editorial  codechef comproblemswaypa tags                                   binarysearch centroiddecomposition dec gomelfk hard hashing                                                                                        difficulty rating                        date added  time limit  secs source limit  bytes languages pyth   java c cpp pyth pyp cs ada pypy text pas fpc nodejs ruby php go hask tcl perl scala lua bash js lisp sbcl pas gpc bf cloj d caml fort asm fs wspc lisp clisp scm guile perl erl clps prlg ick nice icon scm chicken pike scm qobi st nem  submit