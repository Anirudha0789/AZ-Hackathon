  read problems statements in mandarin chinese  and russian  you are given a string s of length n consisting only of s and s  you are also given an integer k  you have to answer q queries  in the ith query two integers li and ri are given  then you should print the number of substrings of sl r which contain at most k s and at most k s where sl r denotes the substring from lth to rth characters of the string s   in other words you have to count number of pairs i j of integers such that l ≤ i ≤ j ≤ r such that no character in substring si j occurs more than k times  input the first line of input contains an integer t denoting the number of test cases  then t test cases follow  the first line of each test case contains three spaceseparated integers n k and q as described in the problem  the second line contains a string s of length n  then the next q lines describe the query where the ith line of them contains two spaceseparated integers li and ri  output for each query print the required answer in a single line  constraints and subtasks  ≤ t ≤   ≤ k ≤ n ≤   ≤ q ≤   ≤ li ≤ ri ≤ n sum of n over all test cases in one test file does not exceed  sum of q over all test cases in one test file does not exceed  s consists only of s and s  subtask   points sum of n over all test cases in one test file does not exceed  subtask   points q    ≤ k ≤ min n subtask   points  ≤ q ≤  subtask   points original constraints                          sample input                                                                sample output                               explanation query  consider substring p  s    out of  total substrings of p substrings p  and p  are not valid because both contain more than two s  other substrings contains at most two s and at most two s thus the answer is   query  consider substring p  s    out of  total substrings of p substrings p  is  not valid because it contains more than two s  query  consider substring p  s    out of  total substrings of p substrings p  p  and p  are not valid because all contain more than two s   author ★darkshadows tester ★laycurse editorial  codechef comproblemsstrsub tags                                   string segment trees pre processing bottomup binary search                                                              data structures advanced data structures advanced tree structures advanced algorithms algorithms dynamic programming dp approach searching                                                                                        difficulty rating                        date added  time limit  secs source limit  bytes languages pyth   java c cpp pyth pyp cs ada text pas fpc nodejs ruby php go hask tcl perl scala lua bash js lisp sbcl pas gpc bf cloj d caml fort asm fs wspc lisp clisp scm guile perl erl clps prlg ick nice icon pike scm qobi st nem  submit