  read problems statements in mandarin chinese russian and vietnamese as well  sometimes the stability of a stock market is at least as important as rapid price changes  let a stable block be a maximal consecutive block of days with same stock prices  moreover let a stable block of order k be a stable block of length at least k   for example if stock prices for  consecutive days are        then there are  stable blocks there       and   moreover there are  stable blocks of order  or higher  stable block of order      stable block of order        stable block of order        and  given historical prices of a stock across n days the goal is to answer q customers questions  the ith question contains three integers li ri and ki  it asks for the number of stable blocks of order ki if only the stock prices of the days in the range li ri are considered   input  in the first line there is a single integer t denoting the number of test cases to handle  after that the description of t test cases follow  the first line of each test case contains two spaceseparated integers n and q denoting respectively the number of days for which the stock prices are given and the number of questions to answer   the second line contains n spaceseparated integers a a     an where ai denotes the price of the stock on the ith day   q lines follow  in the ith of them there are three spaceseparated integers li ri and ki denoting the ith query  output  for each test case print answers to all queries in the test case one per line   constraints   ≤ t ≤   ≤ n q ≤   ≤ ai ≤   ≤ li ≤ ri ≤ n  ≤ ki ≤ ri  li    subtasks  subtask   points   ≤ n q ≤   subtask   points  original constraints                          sample input                                                                                          sample output                                   explanation there are two test cases to handle test case  there are  days for which prices are given and  queries to handle  the first query asks for the number of stable blocks of order  in range   which corresponds to prices       the answer is  because there are two such blocks    and    the second query asks for the number of stable blocks of order  in range   which corresponds to prices      the answer is  because there are two such blocks   and    the third query asks for the number of stable blocks of order  in range   which corresponds to prices      the answer is  because there is no stable block of order  there maximum order of a stable block is   the fourth query asks for the number of stable blocks of order  in range   which corresponds to prices        the answer is  because the only stable block of order  here is     the fifth query asks for the number of stable blocks of order  in range   which corresponds to prices        the answer is  because there are  stable blocks of order  there      and    test case  there are  days for which prices are given and  queries to handle  the first query asks for the number of stable blocks of order  in range   which corresponds to prices     the answer is  because the only such block there is     the second query asks for the number of stable blocks of order  in range   which corresponds to a single price   the answer is  because the only such block there is    author ★pkacprzak editorial  codechef comproblemssmarket tags                                   segment trees square root decomposition binary search offline queries                                                              advanced data structures advanced tree structures advanced algorithms algorithms searching queries                                                                                        difficulty rating                        date added  time limit  secs source limit  bytes languages pyth   java c cpp pyth pyp cs ada pypy text pas fpc nodejs ruby php go hask tcl perl scala lua bash js lisp sbcl pas gpc bf cloj d caml fort asm fs wspc lisp clisp scm guile perl erl clps prlg ick nice icon scm chicken pike scm qobi st nem  submit