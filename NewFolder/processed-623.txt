 read problems statements in mandarin chinese russian and vietnamese as well  you are working in a company with n employees numbered from  to n   and employee  is the director  each employee except the director has a supervisor  the director doesnt have a supervisor  lets call employee v an ancestor of employee u if and only if v is the supervisor of u or v is an ancestor of the supervisor of u  also each employee belongs to exactly one club at any moment  employee i belongs to club number ci initially  the company has assemblies for which all the employees of the company gather  during an assembly the employees introduce each other in a particular fashion  employee v introduces employee a to employee b if a b v are from the same club a is ancestor of v and v is ancestor of b  also some employees may change their club  you are given these changes and you need to calculate the total number of introduces if an assembly was to be held after each such club membership change  input  the first line contains two integers n and q denoting the number of employees in the company and the number of club membership changes respectively  the second line contains n   spaceseparated integers p p     pn   denoting the supervisors  pi is the supervisor of employee i  the third line contains n spaceseparated integers c c     cn   denoting the clubs  ci is the club that employee i belongs to initially  then q lines follow which contain the numbers x x    xq one in each line  that is line number i   contains xi  what it denotes is explained below  the queries are encoded and have to be decoded online  the ith change i running from  to q is that employee number i   mod n changes his club to xi  ans mod n  where ans is the previous output note that even for i   there is a previous output because as is explained below the first output has to be before any change  output you have to output q   lines  line number i   should contain the answer for the original company after first i changes  that is you should output the answer for the original company and then after each club membership change  constraints   ≤ n ≤   ≤ q ≤   ≤ pi  i  ≤ ci  n  ≤ xi  n  subtasks  subtask   points n q ≤  subtask   points n ≤  subtask   points n q ≤  subtask   points original constraints                         sample input                                                                          sample output                               explanation we represent employee v introducing employee a to employee b by the triplet a v b  initially before any change there are a total of  introduces  they are                    so the first output is   so ans   now  to decode the first change we consider x  ans mod n     mod     so employee i   mod n  employee  changes his club to   after this change the number of introduces reduces  there is no new introduce triplet formed but the triplets       and    are no longer valid  hence there are only  introduces which are           so the second output is  and ans becomes  now  to decode the second change we consider x  ans mod n     mod     so employee i   mod n  employee  changes his club to   now some old introduces are lost and some new ones formed  the introduces after this change are        so the third output is    author ★grumpygordon tester ★lg tags                                   treap segment trees dfs                                                              advanced data structures advanced tree structures algorithms graph algos traversals                                                                                        difficulty rating                        date added  time limit    secs source limit  bytes languages pyth   java c cpp pyth pyp cs ada pypy text pas fpc nodejs ruby php go hask tcl perl scala lua bash js lisp sbcl pas gpc bf cloj d caml fort asm fs wspc lisp clisp scm guile perl erl clps prlg ick nice icon scm chicken pike scm qobi st nem  submit