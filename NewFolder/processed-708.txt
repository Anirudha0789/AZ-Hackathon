  read problems statements in mandarin chinese russian and vietnamese as well   you are given a tree consisting of n nodes numbered from  to n  the weights of edges of the tree can be any binary integer satisfying following q conditions   tteach condition is of form u v x where u v are nodes of the tree and x is a binary number   ttfor satisfying this condition  sum of the weight of all the edges present in the path from node u to v of the tree should have even if x   odd otherwise   t  now you have to find out number of ways of assigning  binary weights to the edges of the tree satisfying the above conditions  as the answer could be quite large print your answer modulo      input  the first line of input contains a single integer t denoting number of test cases  for each test case t first line contains two space separated integers n q  each of the next n   lines will contain two space separated integer  u v denoting that there is an edge between vertex u and v in the tree  each of the next q lines will contain three space separated integer  u v x denoting a condition as stated in the probelm   output  for each test case output a single integer corresponding to the answer of the problem   constraints   ≤ u v ≤ n  ≤ x ≤   subtasks  subtask    points  sum of each of variables n and q over all the test cases ≤   subtask    points  sum of each of variables n and q over all the test cases ≤   subtask    points  sum of each of variables n and q over all the test cases ≤   subtask    points  sum of each of variables n and q over all the test cases ≤                           sample input                                                                                 sample output                               explanation in the first example  you can only set the weight of each edge equal to  for satisfying the given condition  so there is exactly one way of doing this  hence answer is    in the second example  there are two edges and there is no condition on the edges  so you can assign them in  ways    in the third example  you have to assign the weight of edge between node  and  to   you can assign the remaining edge from  to  either  or   so the answer is     author admin tester ★kevinsogo editorial  codechef comproblemsparitree tags                                   graphs disjoint set union  sat connected components coloring                                                              data structures advanced data structures advanced algorithms advanced graph algos algorithms graph algos                                                                                        difficulty rating                        date added  time limit  secs source limit  bytes languages pyth   java c cpp pyth pyp cs ada pypy text pas fpc nodejs ruby php go hask tcl perl scala lua bash js lisp sbcl pas gpc bf cloj d caml fort asm fs wspc lisp clisp scm guile perl erl clps prlg ick nice icon scm chicken pike scm qobi st nem  submit