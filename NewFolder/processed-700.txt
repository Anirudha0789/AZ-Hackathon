  read problems statements in mandarin chinese russian and vietnamese as well   bearland can be represented as a square grid that consists of n rows and n columns  two cells are called adjacent if they share a side  in the input each cell is described by one character   is an empty cell  b g or p is a cell inhabited by bears of one species — brown grizzly or polar bears respectively   is a cell inhabited by bears of one species but you dont know which one  note that this cell cant be empty   grizzly bears are the most aggressive species  if a cell is inhabited by grizzly bears all adjacent cells should be empty because otherwise there would be fights between bears  brown and polar bears are a bit calmer  all brown bears are fine with other brown bears in adjacent cells but they would fight with bears of any other species  similarly polar bears would fight with bears of any species other than polar bears  let x denote the number of question marks  since each question mark represents one of the three species there are x ways to replace them with characters b g and p denoting the species that live in that cell  find the number of such ways that there are no fights between bears  print the answer modulo   input the first line of the input contains an integer t denoting the number of test cases  the description of t test cases follows   the first line of each test case contains an integer n denoting the size of the grid   the following n lines describe the grid  each of those lines contains a string of length n  each character is one of five    b g p   output for each test case output a single line containing one integer — the number of ways to replace question marks to avoid fights in bearland modulo   constraints   ≤ t ≤   ≤ n ≤   subtasks  subtask   points  ≤ n ≤  subtask   points each character in the grid will be either   or   subtask   points original constraints   example input       b g    gg             p  b                                  pp pp  output        explanation test case   we are given the grid of size  ×   one of the already fixed cells is inhabited by brown bears  they would fight with bears of any species other than brown bears so adjacent cells with question marks must by inhabited by brown bears as well  hence there is only  way to replace question marks both of them must be replaced by b  test case   in the given grid there are two adjacent cells both inhabited by grizzly bears  they will fight with each other so the answer is  — its impossible to replace question marks so that there would be no fights it doesnt matter that there are no question marks at all  test case   there are  ways b   b   g   g   p   p    bb  pp  bb  pp  bb  pp bb  pp  bb  pp  bb  pp   test case   no matter how we replace question marks bears in some two adjacent cells will start a fight  the answer is    author ★errichto tester ★kingofnumbers editorial  codechef comproblemsspecies tags                                   flood fill dfs                                                              algorithms graph algos traversals                                                                                        difficulty rating                        date added  time limit  secs source limit  bytes languages pyth   java c cpp pyth pyp cs ada pypy text pas fpc nodejs ruby php go hask tcl perl scala lua bash js lisp sbcl pas gpc bf cloj d caml fort asm fs wspc lisp clisp scm guile perl erl clps prlg ick nice icon scm chicken pike scm qobi st nem  submit