 read problem statements in hindi bengali mandarin chinese russian and vietnamese as well  after failing to clear his school mathematics examination infinitepro decided to prepare very hard for his upcoming reexam starting with the topic he is weakest at ― computational geometry  being an artist infinitepro has cc pencils numbered  through cc each of them draws with one of cc distinct colours  he draws nn lines numbered  through nn in a d cartesian coordinate system for each valid ii the iith line is drawn with the cicith pencil and it is described by the equation yai⋅xbiyai⋅xbi  now infinitepro calls a triangle trulygeometric if each of its sides is part of some line he drew and all three sides have the same colour  he wants to count these triangles but there are too many of them after a lot of consideration he decided to erase a subset of the nn lines he drew  he wants to do it with his eraser which has length kk  whenever erasing a line with a colour ii the length of the eraser decreases by vivi  in other words when the eraser has length kk and we use it to erase a line with a colour ii the length of the eraser decreases to k−vik−vi if kvikvi it is impossible to erase such a line  since infinitepro has to study for the reexam he wants to minimise the number of trulygeometric triangles  can you help him find the minimum possible number of trulygeometric triangles which can be obtained by erasing a subset of the nn lines in an optimal way he promised a grand treat for you if he passes the examination input  the first line of the input contains a single integer tt denoting the number of test cases  the description of tt test cases follows  the first line of the input contains three spaceseparated integers nn cc and kk  nn lines follow  for each ii ≤i≤n≤i≤n the iith of these lines contains three spaceseparated integers aiai bibi and cici  the last line contains cc spaceseparated integers vv…vcvv…vc   output for each test case print a single line containing one integer ― the smallest possible number of trulygeometric triangles after erasing lines  constraints  ≤t≤≤t≤ ≤c≤n≤≤c≤n≤ ≤k≤≤k≤ ≤aibi≤≤aibi≤ for each valid ii ≤ci≤c≤ci≤c for each valid ii ≤vi≤k≤vi≤k for each valid ii no two lines coincide regardless of their colours no three lines are concurrent  subtasks subtask   points  n≤n≤ k≤k≤  subtask   points  vv…vcvv…vc no two lines are parallel  subtask   points no two lines are parallel subtask   points original constraints                          sample input                                                                                                      sample output                              explanation example case  we can remove exactly one line  initially we have  truly geometric triangles see the image below red is colour  and green is colour    removing any line with colour  brings the total number of trulygeometric triangles down to   removing any line with colour  brings the total number of trulygeometric triangles down to    thus the smallest number of trulygeometric triangles we can obtain is    example case  we can remove at most  lines and removing any  lines gives us a total of  trulygeometric triangles   author ★infinitepro editorial  codechef comproblemsaccbip tags                                   geometry dynamic programming implementation                                                              mathematics algorithms                                                                                        difficulty rating                        date added  time limit  secs source limit  bytes languages cpp pyth   java c cpp pyth pyp cs ada pypy text pas fpc nodejs ruby php go hask tcl kotlin perl scala lua bash js rust lisp sbcl pas gpc bf cloj r d caml swift fort asm fs wspc lisp clisp sql scm guile perl erl clps prlg sqlq ick nice icon cob scm chicken pike scm qobi st nem  submit