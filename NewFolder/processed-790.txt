 read problems statements in mandarin chinese russian and vietnamese as well   pishty is a little boy who lives in khust an ancient town with a castle and smart bears  right now he wants you to help him with a programming problem  you are given a sequence a a     an and q queries  there are two types of queries   pos val — set apos  val   l r — find the maximum possible perimeter of a triangle with nonzero area whose sides are elements of the subsequence al al     ar  note that each element of the subsequence can only be used as the length of at most one side i e  the sides of each valid triangle must be elements ax ay az where l ≤ x  y  z ≤ r   for each query of the second type compute the maximum possible perimeter or determine that no valid triangle exists   input  the first line of the input contains two spaceseparated integers n and q  the second line contains n spaceseparated integers a a     an  q lines follow  each of these lines describes one query in the following format   pos val for a query of the first type  l r for a query of the second type output for each query of the second type print a single line containing one integer — the maximum perimeter or  if no triangle can be formed  constraints   ≤ n q ≤   ≤ ai ≤  for each valid i  ≤ val ≤   ≤ l ≤ r ≤ n  ≤ pos ≤ n   subtasks subtask   pts  ≤ n q ≤  subtask   pts  ≤ n q ≤  subtask   pts original constraints                          sample input                                                                        sample output                               explanation the first query asks us to find the maximum perimeter of a triangle using some of the elements       we can take the elements   and  and construct a triangle using these three elements as side lengths  this triangle has perimeter        which is the maximum possible perimeter  hence the answer is   the second query asks us to change the second element to   the third query asks us to find the maximum perimeter of a triangle using some of the elements     these three elements do not form a triangle hence the answer is   the fourth query asks us to find the maximum perimeter of a triangle using some of the elements      we can take the elements   and  and make a triangle using these three elements as side lengths  this triangle has perimeter        which is maximum possible  hence the answer is    author ★fekete editorial  codechef comproblemspshtrg tags                                   segment trees sorting                                                              advanced data structures advanced tree structures algorithms                                                                                        difficulty rating                        date added  time limit  secs source limit  bytes languages cpp pyth   java c cpp pyth pyp cs ada pypy text pas fpc nodejs ruby php go hask tcl kotlin perl scala lua bash js rust lisp sbcl pas gpc bf cloj d caml swift fort asm fs wspc lisp clisp scm guile perl erl clps prlg ick nice icon cob scm chicken pike scm qobi st nem  submit