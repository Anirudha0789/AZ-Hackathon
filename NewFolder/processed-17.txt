 a thermal decomposition reaction is breakdown of a compound into one or more compounds when heated  for example p→a⋅qb⋅rp→a⋅qb⋅r is a decomposition reaction  here  unit of pp is converted into aa unit of qq and bb unit of rr after completion of the reaction  you are given nn compounds numbered from  to nn  the initial amount of the ithith compound is qiqi   you are also given mm equations  every equation is of the form  c→w⋅cw⋅c…wx⋅cxc→w⋅cw⋅c…wx⋅cx  here  cc represents the compound which will decompose into xx compounds on heating  cici ≤i≤x≤i≤x represents the compounds into which cc is decomposed  wiwi ≤i≤x≤i≤x represents the number of units of cici produced due to the decomposition of cc  cici−cici− for all ≤i≤x≤i≤x   note that a compound can decompose in at most one way only  find the final amount of each compound after prolonged heating  since the number can be huge print the answer modulo   input format  first line will contain two space separated integers nn and mm  the number of compounds and the number of equations  second line will contain nn space separated integers qq   qnqq   qn  the initial amounts of each compound  the next ⋅m⋅m lines contain the details of the mm equations   each equation is represented using  lines  first line of the ithith equation contains two space separated integers cici xixi  the decomposing compound and the number of compounds in which it decomposes  second line of the ithith equation contains ⋅xi⋅xi space separated integers wiciwici…wixicixiwiciwici…wixicixi  the number of units and the types of compounds into which cici decomposes    output format print nn lines  the ithith line contains a single integer denoting the final amount of the ithith compound after prolonged heating modulo   constraints  ≤mn≤≤mn≤ ≤qi≤qi ≤cin≤cin ≤xi≤n−ci≤xi≤n−ci ≤wij≤wij ∀∀ ≤j≤xi≤j≤xi and ≤i≤m≤i≤m  cijcijcijcij ∀∀ ≤jxi≤jxi and ≤i≤m≤i≤m  cicicici ∀∀ ≤im≤im  sum of xixi over all test cases does not exceed ⋅⋅                          sample input                                                                     sample output                                explanation test cse  we have  compounds initially  for better explanation we refer the compounds  and  as aaaaaa and aa respectively  initially the amount of aaaaaa and aa present is  and  respectively  the two equations are  a→⋅a⋅aa→⋅a⋅a a→⋅aa→⋅a  we know that  unit of aa produces  units of aa and  units of aa  thus the initial  units of aa decompose to ⋅⋅ units of aa and ⋅⋅ units of aa  note that now there are  units of aa left  considering only this reaction the updated amounts of chemicals would be   we also know that  unit of aa decomposes to  units of aa  the total amount of aa available for decomposition would be  units  units were available initially and  units were formed due to decomposition  thus these  units would produce ⋅⋅ units of aa  thus after prolonged heating the amounts of compounds are    author ★ultimatezero editorial  codechef comproblemsdcp tags                                   array dynamicprogramming easy start ultimatezero                                                                                        difficulty rating                        date added  time limit  secs source limit  bytes languages cpp pyth   java c cpp pyth pyp cs ada pypy text pas fpc nodejs ruby php go hask tcl kotlin perl scala lua bash js rust lisp sbcl pas gpc bf cloj r d caml swift fort asm fs wspc lisp clisp sql scm guile perl erl clps prlg sqlq ick nice icon cob scm chicken pike scm qobi st nem  submit