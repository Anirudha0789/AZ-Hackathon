  read problems statements in mandarin chinese russian and vietnamese as well   treeland is a country consisting of n cities numbered from  to n  the road network connecting these cities has tree structure i e  there is exactly one way of going from a city to another city via a path of roads   there are k gangs living in the city numbered from  to k  gangs operate  over various cities engaging in illicit trades  there might be more than one gangs operating in some cities  sometimes they form alliances by grouping up with other gangs thus making the city even more unsafe  they significantly increase their reach of the cities they control  specially the region controlled by the alliance will be the all the cities where some gang in the alliance operates and also all the cities which lie in a path between some two cities controlled by the alliance  chef being a mayor of treeland wants to choose one city as the capital in which he will establish headquarter of police department  but first he wants to make some investigations by finding the answers of following queries  can you please help him in this in each query you will be given the city chef wants to be the capital  also you will be given some set of gangs out of the above k gangs  for this query assume that only the given set of gangs are operating in the city others are inactive or perhaps caught up and put in the jail  chef wants to catch some member of the alliance formed by the operating gangs so that he can get the information about the members of entire alliance  for that he wants to find out the nearest distance of some city controlled by the alliance from the capital city  it might be the case that the capital itself is controlled by the alliance in that case nearest distance will be zero obviously   please note that all the queries are independent of each other   input the first line of the input contain an integer n denoting the number of cities in treeland  each of the next n lines contains two space separated integers u v denoting that city u and v are connected by a road  the next line contains an integer k denoting the number of gangs operating in treeland  each of the next k lines provides a description of cities controlled by a gang  in particular in the ith line you will be provided some space separated integers  first integer ci will denote the number of cities controlled by the ith gang which will be followed by ci integers denoting the list of cities controlled by the gang  next line contains an integer q denoting the number of queries chef wants you to answer  next q lines contain description of the queries one query per line  the first integer will denote the capital city v followed by an integer ti denoting the number of gangs active for the purpose of this query followed by  ti integers denoting the list of the gangs  output for each query output a single integer corresponding to the answer of the query  constraints   ≤ n ≤   ≤ k ≤   ≤ q ≤   ≤ sum of ci over all the k gangs ≤   ≤ sum of ti over all the q queries ≤   ≤ ci ≤ n  ≤ ti ≤ k for each gang i in the input the list of cities controlled by the gang wont contain repeated elements for each query the list of gangs active wont contain repeated elements   example input                               output     explanation in query   there is only one active gang for this query i e  gang   gang  operates in city   their alliance will control city  itself  chef wants city  to be the capital city  distance between city  and  is   in query   there is only active gang for this query i e  gang   gang  operates in cities    the alliance will control the cities   and   chef wants city  to be the capital city  the minimum distance city controlled by alliance from the city  is  which is at a distance of   in query   there are two active gang for this query i e  gang  and   gang  operates in cities   whereas gang  operates in city    their alliance will control the cities       i e  all the cities except city   chef wants to be city  capital  the minimum distance city controlled by the alliance from the city  is  which is at a distance of   note please note that default stack size is mb for c and mb for java                                                                                       author ★kingofnumbers tester  editorial  codechef comproblemsalliance tags                                   binarysearch kingofnumbers lowestcommonancestor snckel                                                                                        difficulty rating                       na date added  time limit   secs source limit  bytes languages pyth   java c cpp pyth pyp cs ada pypy text pas fpc nodejs ruby php go hask tcl perl scala lua bash js lisp sbcl pas gpc bf cloj d caml fort asm fs wspc lisp clisp scm guile perl erl clps prlg ick nice icon scm chicken pike scm qobi st nem  submit