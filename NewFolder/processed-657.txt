 xa as valentine week is going on bajrang dal is in mood to execute their plans on upcoming valentines day  today they called a meeting of all the members to decide their plans  after the discussions they came to an idea  the idea is as follows the leader of the dal will be having a huge string upto  characters known master string m  and all the coordinators of the dal will visit all the parks and places of the city where there is probability to find the couples  their task is to bring them to the leader of the group  after that the leader will assign a number to each of the couples  the number assigned is the length of substring of master string such that name of both the coupleslet a and b is present in that substring  if there are multiple substrings containing name of both the couples the number assigned is the length of the substring which is having minimum length  after the number is assigned to all the couples leader of the dal puts a condition among them to set them free  he told them to divide themselves in two groups such that if they take xor of assigned numbers of all the couples the result after addition of xor of both the groups is maximum  can you help them  lets consider p is the xor of all the number of first group and q is the xor of all the numbers of second group  you need to maximise p  q  if there are multiple ways to divide the couples so that the previous condition fulfilled then minimize the value p  note there is always a substring in the master string which will contain the names of both in the couple  input first line of each test file is a strigs the master string  second line conatins the number of couples n that the coordinaters brought to the leader  next n lines contains two strings a and b the name of both in the couple  output print n spaceseparated integers the ith of them should equal either  if this couple should be kept in first group or  if it kept in second group  contraints  ≤ length of m ≤   ≤ n ≤   ≤ length of ab ≤  sample input akashikharishasenorita  shikhar isha aka norita harish isha sample output    explanation master string m is akashikharishasenorita  minimum length substring of this string which contains the name of couples is as follows  names minlength substring shikhar isha   shikharisha aka norita  akashikharishasenorita harish isha  harisha  now our array is   we have to divide the array in two parts such that xor sum of both the array is maximum   some of the combinations are  and  xor sum is         and  xor sum is         and  xor sum is          and   xor sum is        as we have to minimize the xor of first group we would choose the rd partition among nd and rd as both are correct   author ★akashrakshit editorial  codechef comproblemscomapr tags                                   akashrakshit binarysearch bitmasking com hard strings                                                                                        difficulty rating                       na date added  time limit    secs source limit  bytes languages pyth   java c cpp pyth pyp  submit