 the only difference between the easy and hard versions is the contraints  in the new secret nasa there are n astronauts  professor brand wants to form a team headed by dr mann for the lazarus mission  astronauts will team up in pairs for the mission  but there is one condition two astronauts will team up with one another if and only if each person believes that the other person is good enough for him  an astronaut considers another good enough for him if and only if the other person has an astronaut rating of at least half of his own  the professor now wonders how many pairs can be formed among the astronauts  find the number of pairs possible  input format  the first line contains tt the number of test cases  for each test case the first line contains nn the number of astronauts  the next line has nn integers the ratings of the astronauts   constraints  ≤t≤≤t≤ ≤n≤≤n≤ ≤ai≤≤ai≤  output format output one line for each test case  the number of pairs possible among the astronauts  sample input                sample output     author ★shriramc editorial  codechef comproblemssopcc tags                                   binarysearch medium shpc shriramc twopointers                                                                                        difficulty rating                       na date added  time limit  secs source limit  bytes languages pyth   java c cpp pyth pyp cs ada pypy text pas fpc nodejs ruby php go hask tcl kotlin perl scala lua bash js rust lisp sbcl pas gpc bf cloj r d caml swift fort asm fs wspc lisp clisp sql scm guile perl erl clps prlg ick nice icon cob scm chicken pike scm qobi st nem  submit