 read problem statements in bengali mandarin chinese russian and vietnamese as well  chef wants to study reactions between nonmiscible reagent samples with different colours  there are nn colours numbered  through nn  chef has nn test tubes numbered  through nn each of them can hold a volume mm ml initially tubes nn and nn are empty while for each ii ≤i≤n≤i≤n the iith tube is completely filled and contains mm ml of reagents with some colours  since reagents with different colours do not mix we can describe the contents of the iith tube from its bottom to its top by a sequence bibi…bimbibi…bim i e  for each valid jj the jjth mililiter of volume of the iith tube measured from the bottom is filled by a reagent with a colour bijbij  the total initial volume of each reagent is equal to mm ml  to facilitate his study chef wants to redistribute the reagents into tubes according to their colours i e  at the end for each colour ii there must be exactly one tube which contains all mm ml of this reagent and no reagents with other colours  the specific positions of reagents or empty tubes in this final state do not matter  in order to achieve this you may first reverse the order of reagents in some possibly none or all tubes  then you may perform operations of two types  choose two test tubes pp and qq and transfer the topmost  ml of reagent from the tube pp to the top of the tube qq  this is only allowed if pp is nonempty and qq is not full  if qq is empty the cost of this operation is   otherwise lets denote the colour of the topmost reagent in tube pp by uu and the colour of the topmost reagent in qq before this operation by vv  if duv−duv− this operation is not allowed  otherwise it is allowed and its cost is duvduv  choose a test tube pp and increase its capacity by  ml  the cost of this operation is cpcp   you are given the costs of pouring reagents on top of each other and information about which reagents react with each other and therefore cannot be poured on top of each other i e  the matrix dd  it is guaranteed that dijdjidijdji for each valid ii and jj and diidii for each valid ii  you must separate the reagents reach the state described above using no more than  operations  the sum of costs of the operations you use to achieve this should be as small as possible  input  the first line of the input contains two spaceseparated integers nn and mm  the second line contains nn spaceseparated integers cc…cncc…cn  nn lines follow  for each valid ii the iith of these lines contains nn spaceseparated integers didi…dindidi…din  nn more lines follow  for each valid ii the iith of these lines contains mm spaceseparated integers bibi…bimbibi…bim   output  first print a single line containing two spaceseparated integers xx and yy ≤x≤n≤x≤n ≤y≤≤y≤ ― the number of test tubes whose contents you wish to initially reverse and the number of operations you wish to perform  then print a single line containing xx spaceseparated integers aa…axaa…ax ― the numbers of the test tubes you wish to initially reverse ≤ai≤n≤ai≤n for each valid ii  then print yy lines describing the operations in the order in which you wish to perform them  to perform an operation of the first type print a line containing three spaceseparated integers  pp and qq ≤pq≤n≤pq≤n p≠qp≠q  to perform an operation of the second type print a line containing two spaceseparated integers  and pp ≤p≤n≤p≤n   constraints  nn mm ≤ci≤≤ci≤ for each valid ii −≤dij≤−≤dij≤ for each valid ijij dijdjidijdji for each valid ijij diidii for each valid ii ≤bij≤n≤bij≤n for each valid ijij  example input                                          example output                                                              explanation the initial arrangement of reagents in test tubes is  after reversing the contents of the st and rd test tube the arrangement becomes  after the first  operations the arrangement becomes  after the first  operations  after the first  operations  after all  operations the reagents get separated  the cost paid for the th operation is  and the cost paid for the th operation is   the cost paid for all other operations is   thus the reagents are separated with a total cost   note that this is not necessarily an optimal way to separate the reagents  in the actual test data nn is  and mm is   smaller values have been used in this example for clarity  test generation the generator used to generate the test cases can be found here   nn mm initially for each ii ≤i≤n≤i≤n the iith test tube is completely filled with mm ml of the reagent with colour ii  a parameter g∈g∈ is chosen and the following operation is performed gg times two different test tubes ee and ff such that ee is not empty are chosen randomly and  ml of reagent is transferred from top of ee to ff  we consider the capacities of the tubes to be infinite here  then for each test tube that contains more than mm ml of reagents the volume of reagents in it is decreased to mm by transferring excess reagents in whole mililiters from the top into tubes that contain less than mm ml of reagents randomly  then the test tubes nn and nn are made empty by transferring their contents randomly to other test tubes that contain less than mm ml of reagents  the values of cc…cncc…cn are chosen uniformly randomly and independently between  and  inclusive  then another parameter k∈k∈ is chosen  finally nn−knn−k distinct unordered pairs of distinct colours are chosen randomly  for each of these pairs uvuv ≤uv≤n≤uv≤n duvdvuduvdvu is chosen uniformly randomly and independently between  and  inclusive  for all other such pairs duvdvu−duvdvu−   there are  test files corresponding to all possible combinations of parameters gg and kk  scoring the checker used to determine the score of your submission can be found here  if you perform an invalid operation or the reagents are not separated after all the operations particularly if there is a test tube which contains reagents with more than one colour or there is a colour which appears in more than one test tube then you will receive the wrong answer verdict  otherwise the score for a test file is the total cost of all the operations  the score of a submission is the sum of scores of all test files  your goal is to minimise this score  there are  test files  during the contest the displayed score will account for exactly  test files i e  your score reflects your submissions performance on   of the test files  however if your program gets a nonac verdict on any test file your submissions verdict will be nonac  in other words an ac verdict denotes that your program runs successfully on all the test files  after the end of the contest your score will be changed to include the sum of your programs scores over the other  test files   author ★jay editorial  codechef comproblemswtrsort tags                                   april greedy heuristic implementation jay tiebreaker                                                                                        difficulty rating                        date added  time limit  secs source limit  bytes languages cpp pyth   java c cpp pyth pyp cs ada pypy text pas fpc nodejs ruby php go hask tcl kotlin perl scala lua bash js rust lisp sbcl pas gpc bf cloj r d caml swift fort asm fs wspc lisp clisp sql scm guile perl erl clps prlg sqlq ick nice icon cob scm chicken pike scm qobi st nem  submit