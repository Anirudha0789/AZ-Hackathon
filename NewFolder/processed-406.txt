 suppose that you have several powers of two specifically you have aiai numbers equal to ii for each ≤i≤n≤i≤n  you want to divide all of these numbers into two groups with equal sum  however its not always possible  to make it possible in one operation you are allowed to choose any ≤i≤n≤i≤n and receive an extra number ii in other words you can increase any aiai by   lets define faa…anfaa…an as the smallest number of operations that you need to make to be able to split the numbers into two groups with equal sums  you are given nn integers bb…bnbb…bn  find the sum of faa…anfaa…an over all tuples aa…anaa…an with ≤ai≤bi≤ai≤bi there are bb…bnbb…bn of them  as this number may be very large output it modulo   input format  the first line of the input contains a single integer tt the number of test cases  the description of the test cases follows  the first line of each test case contains a single integer nn −− the number of integers  the second line of each test case contains nn spaceseparated integers bb…bnbb…bn   output format for each test case output the answer modulo  on a new line  constraints  ≤t≤≤t≤ ≤n≤≤n≤ ≤bi≤≤bi≤ the sum of nn over all test cases doesnt exceed                           sample input                                                                        sample output                                explanation test case  there are  tuples  and   we have ff there are no numbers so divide them into two empty sets and ff we have one number namely   use one operation to receive a second copy of  and then place these copies in different sets  the answer is thus  test case  there are  tuples with their function values as follows  ff ff receive  ff receive  ff receive  and  then split as  and  both with sum  ff ff receive   add all these up to get  which is the output   author trygubadm editorial  codechef comproblemssplitpowof tags                                   cook dynamicprogramming greedy trygubadm                                                                                        difficulty rating                        date added  time limit  secs source limit  bytes languages cpp pyth   java c cpp pyth pyp cs ada pypy text pas fpc nodejs ruby php go hask tcl kotlin perl scala lua bash js rust lisp sbcl pas gpc bf cloj r d caml swift fort asm fs wspc lisp clisp sql scm guile perl erl clps prlg sqlq ick nice icon cob scm chicken pike scm qobi st nem  submit