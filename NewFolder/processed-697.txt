  read problems statements in mandarin chinese  and russian   consider directed graph which has n   layers numbered from left to right by integers from  up to n    the leftmost  and the rightmost n   layers both contain only one vertex while every other layer contains exactly m vertices  vertices are numbered independently in each layer by integers from  to m    for each pair of vertices which are in the adjacent layers i and i   for any i   i  n there exists an edge  the vertex which is in the layer with smaller number is the initial vertex for such edge and the other one is the terminal vertex  based on a graph as described above chef added k more edges  each edge connects two vertices which are in the different layers no matter the adjacent layers or not  also each edge is directed from left to right as well as all previously existing edges  chef is interested in the number of ways to get from the leftmost layer to the rightmost one  two paths are considered different if there is at least one edge which belongs to exactly one path  however they are allowed to traverse the same set of vertices  in that case there should be a multiple edge in the graph  it is also possible if some edge added by chef connects two adjacent layers   input the first line of the input contains three spaceseparated integers n m and k  k lines follow  each of them describes one of the k additional edges and contains four spaceseparated integers edgei where   i    first two integers are for the initial vertex and the other two  for the terminal one  two integers each vertex is described by are the number of the layer edge and edge respectively and number of the vertex in its layer edge and edge respectively  output output a single integer the number of ways to reach the last layer from the initial one modulo     constraints    n     m     k     for each added edge   layers   edge  edge  n numbers inside the layer  in general   edge edge  m when edge   edge   when edge  n   edge    subtasks  subtask  n m   k    points subtask  n m   k    points subtask  original constraints  points  example input             output   explanation consider the graph without  edges added by chef  there are  ways to get from the layer  to the layer   now recall added edges  there are  ways to get from the layer  to the layer  using the edge                and            and also  way to do it using the edge              note that there is no path traversing both added edges    author ★malinovsky tester ★shangjingbo editorial  codechef comproblemschefgrph tags                                   directed acyclic graphs binary exponentiation dp approach                                                              data structures graphs directed graphs mathematics number theory exponentiation algorithms dynamic programming                                                                                        difficulty rating                        date added  time limit  secs source limit  bytes languages pyth   java c cpp pyth pyp cs ada text pas fpc nodejs ruby php go hask tcl perl scala lua bash js lisp sbcl pas gpc bf cloj d caml fort asm fs wspc lisp clisp scm guile perl erl clps prlg ick nice icon pike scm qobi st nem  submit