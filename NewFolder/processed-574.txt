 read problems statements in hindi mandarin chinese russian vietnamese and bengali as well  alice thought of a function ff which takes an arbitrary array of integers aaa…amaaa…am as the only argument and is defined in the following way  consider all pairs of subarrays aiai…ajaiai…aj and akak…alakak…al such that ≤i≤jk≤l≤m≤i≤jk≤l≤m both subarrays are nondecreasing aj≤akaj≤ak if there is no such pair of subarrays fafa  otherwise fafa is the maximum of the expression j−il−kj−il−k over all such pairs of subarrays   in other words you need to choose two nonoverlapping nonempty subarrays of aa and concatenate them in the same order the resulting array should be nondecreasing and fafa is its maximum possible length  bob challenged alice to solve the following problem and she needs your help  you are given a tree with nn vertices numbered  through nn rooted at the vertex   there is an integer written in each vertex for each valid ii lets denote the integer written in vertex ii by vivi  you should choose one vertex ― lets denote it by vv  then consider an array aa containing values which are written in vertices on the path from the root to vv inclusive in this order and calculate fafa  find the maximum possible value of fafa which you can obtain this way  input  the first line of the input contains a single integer tt denoting the number of test cases  the description of tt test cases follows  the first line of each test case contains a single integer nn  the second line contains nn spaceseparated integers vv⋅vnvv⋅vn  each of the following n−n− lines contains two spaceseparated integers uu and vv denoting that vertices uu and vv are connected by an edge   output for each test case print a single line containing one integer ― the maximum of fafa  constraints  ≤t≤≤t≤ ≤n≤⋅≤n≤⋅ vi≤vi≤ for each valid ii ≤uv≤n≤uv≤n the sum of nn over all test cases does not exceed                          sample input                                                                 sample output                             explanation example case  we choose vv  then aa its subarrays  and  satisfy all required conditions and the sum of their lengths is   there is no way to get a greater value of the function ff   author ★manishtanwar editorial  codechef comproblemsjtsartr tags                                   segment trees dynamic programming dfs                                                              advanced data structures advanced tree structures algorithms graph algos traversals                                                                                        difficulty rating                        date added  time limit  secs source limit  bytes languages cpp pyth   java c cpp pyth pyp cs ada pypy text pas fpc nodejs ruby php go hask tcl kotlin perl scala lua bash js rust lisp sbcl pas gpc bf cloj r d caml swift fort asm fs wspc lisp clisp sql scm guile perl erl clps prlg sqlq ick nice icon cob scm chicken pike scm qobi st nem  submit