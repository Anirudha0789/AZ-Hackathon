 read problem statements in hindi bengali mandarin chinese russian and vietnamese as well  chef is very happy today because he got an offer from gordon ramsay himself to work for him in london  chef wants to prepare a delicious cake for gordon to impress him but he does not know that gordon ramsay is not easy to impress  gordon cut chefs cake into nn small slices numbered  through nn placed in a row in such a way that for each valid ii slices ii and ii are adjacent  note that slices nn and  are not adjacent  for each valid ii the iith slice has taste aiai  gordon wants to put special toppings on some slices and then ask chef to group all slices into kk clusters in such a way that the slices in each cluster form a contiguous sequence and the sweetness of the cake is maximum possible  for each valid ii lets denote the topping on the iith slice by titi titi if there is no topping on this slice the sweetness of this slice is ti⋅aiti⋅ai so the sweetness of a slice without any special topping is   the sweetness of a cluster is the total summed up sweetness of all slices in this cluster  lets denote the sweetnesses of all clusters by ss…skss…sk  the sweetness of the whole cake is computed as s∗s∗…∗sks∗s∗…∗sk where the operation ∗∗ is defined in the following way for any nonnegative integers xx and yy such that x≥yx≥y x∗yy∗x∑n⌊logx⌋n⌊xn⌋mod⌊yn⌋mod x∗yy∗x∑n⌊logux⌋n⌊xn⌋mod⌊yn⌋mod  it can be proven that this operation is associative i e  x∗y∗zx∗y∗zx∗y∗zx∗y∗z  you should answer qq queries  in each query you are given the toppings on all slices and the number of clusters kk  tell chef the maximum possible sweetness of the cake input  the first line of the input contains a single integer nn  the second line contains nn spaceseparated integers aa…anaa…an  the next line contains a single integer qq  for each query two lines follow  the first of these lines contains a single integer kk  the second line contains nn spaceseparated integers tt…tntt…tn   output print a single line containing one integer — the maximum sweetness  constraints  ≤q≤≤q≤ ≤n≤≤n≤ ≤k≤≤k≤ ≤ai≤≤ai≤ for each valid ii ≤ti≤≤ti≤ for each valid ii in each query the number of slices with toppings does not exceed   subtasks subtask   points original constraints                          sample input                                                                                       sample output                              explanation for the first query chef can choose clusters in the following way cluster  contains slices  and  cluster  contains slices  through  and cluster  contains slices  through   the sweetness of the cake is ⋅⋅∗⋅⋅⋅⋅⋅∗⋅⋅⋅⋅⋅∗⋅⋅⋅⋅⋅∗⋅⋅⋅   author ★utkarsh editorial  codechef comproblemschefofr tags                                   dp bitmask bitwise operation dynamic programming binary search                                                              advanced algorithms advanced dp mathematics bit manipulation algorithms searching                                                                                        difficulty rating                        date added  time limit  secs source limit  bytes languages pyth   java c cpp pyth pyp cs ada pypy text pas fpc nodejs ruby php go hask tcl kotlin perl scala lua bash js rust lisp sbcl pas gpc bf cloj r d caml swift fort asm fs wspc lisp clisp scm guile perl erl clps prlg ick nice icon cob scm chicken pike scm qobi st nem  submit