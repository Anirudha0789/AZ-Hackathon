  from the faq  what am i allowed to post as a comment for a problem  do not post code  do not post a comment asking why your solution is wrong  do not post a comment asking if you can be given the test case your program fails on  do not post a comment asking how your solution can be improved  do not post a comment giving any hints or discussing approaches to the problem or what type or speed of algorithm is required   problem statement  chef doom has decided to bake a circular cake  he wants to place n colored cherries around the cake in a circular manner  as all great chefs do doom doesnt want any two adjacent cherries to have the same color  chef has unlimited supply of cherries of k ≤  different colors  each color is denoted by the digit from the set       k –   different colors are denoted by different digits  some of the cherries are already placed and the chef wants you to place cherries in the remaining positions  he understands that there can be many such arrangements so in the case when the answer is not unique he asks you to find the lexicographically smallest one  what does it mean lets numerate positions for the cherries by the numbers       n starting from one of the positions in a clockwise direction  then the current possibly partial arrangement of the cherries can be represented by a string of n characters  for each position i of the arrangement if the cherry of the color c is placed at this position then the ith character of the string is equal to the digit c  otherwise it is equal to the question mark   we identify the arrangement with the string that represents it  one arrangement is called lexicographically smaller than the other arrangement if at the first position where they differ the first one has smaller digit we compare only complete arrangements so we dont care about relation between digits and the question mark  for example the arrangement  is lexicographically smaller than  since they have first  equal characters but the th character in the first arrangement is  and it is less than  which is the th character of the second arrangement  notes   the cherries at the first and the last positions are adjacent to each other recall that we have a circular cake   in the case n   any arrangement is valid as long as the color used for the only cherry of this arrangement is less than k   initial arrangement can be already invalid see the case  in the example   just to make all things clear  you will be given a usual string of digits and question marks  dont be confused by circular stuff we have in this problem  you dont have to rotate the answer once you have replaced all question marks by the digits  think of the output like the usual string for which each two consecutive digits must be different but having additional condition that the first and the last digits must be also different of course if n    next you dont have to use all colors  the only important condition is that this string should be lexicographically smaller than all other strings that can be obtained from the input string by replacement of question marks by digits and of course it must satisfy conditions on adjacent digits  one more thing k here is not the length of the string but the number of allowed colors  also we emphasize that the given string can have arbitrary number of question marks  so it can have zero number of question marks as well as completely consists of question marks but of course in general situation it can have both digits and question marks  ok  lets try to formalize things in order to make all even more clear  you will be given an integer k and a string sss   sn where each si is either the decimal digit less than k or the question mark  we are serious  in all tests string s can have only digits less than k  dont ask about what to do if we have digit ≥ k  there are no such tests at all we guarantee this ok lets continue  your task is to replace each question mark by some digit strictly less than k  if there were no question marks in the string skip this step  now if n then your string is already valid  for n   it must satisfy the following n conditions s ≠ s s ≠ s     sn ≠ sn sn ≠ s  among all such valid strings that can be obtained by replacement of question marks you should choose lexicographically smallest one  i hope now the problem is really clear   input  the first line of the input file contains an integer t the number of test cases  t test cases follow  each test case consists of exactly two lines  the first line contains an integer k the number of available colors for cherries  the second line contains a string s that represents the current arrangement of the cherries in the cake   constraints  ≤ t ≤   ≤ k ≤   ≤ s ≤  where s denotes the length of the string s each character in s is either the digit from the set       k –  or the question mark  output  for each test case output the lexicographically smallest valid arrangement of the cherries in the cake that can be obtained from the given arrangement by replacement of each question mark by some digit from  to k –   if it is impossible to place the cherries output no output is case sensitive                          sample input                                                                    sample output                              no     explanation  case   the only possible replacement here is   note that we output  since we can not rotate the answer to obtain  which is smaller  case   arrangement is impossible because cherries at the first and the last positions are already of the same color  note that k   but the string has length   it is normal  k and s dont have any connection  case   there are two possible arrangements  and   the answer is the first one since it is lexicographically smaller  case   there are three possible ways to replace question mark by the digit   and   but the first and the second strings are not valid arrangements as in both of them there exists an adjacent pair of cherries having the same color  hence the answer is the third string  case   note that here we do not use all colors  we just find the lexicographically smallest string that satisfies condition on adjacent digit  case   the string is already valid arrangement of digits  hence we simply print the same string to the output    author kaushadm tester ★antonlunyov editorial  codechef comproblemscakedoom tags                                   brute force implementation                                                              algorithms                                                                                        difficulty rating                        date added  time limit   secs source limit  bytes languages pyth   java c cpp pyth pyp cs ada text pas fpc nodejs ruby php go hask tcl perl scala lua bash js lisp sbcl pas gpc bf cloj d caml fort asm fs wspc lisp clisp scm guile perl erl clps prlg ick nice icon pike scm qobi st nem  submit