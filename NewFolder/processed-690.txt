 read problem statements in hindi bengali mandarin chinese russian and vietnamese as well  you are given an undirected weighted graph with nn vertices numbered  through nn and mm edges numbered  through mm  for each valid ii the iith edge has weight sisi and connects vertices uiui and vivi  the weights of all edges are pairwise distinct  lets denote an edge that connects vertices uu and vv by uvuv  a vibrating path is a sequence of distinct vertices vv…vkvv…vk such that the following conditions are satisfied  ≤k≤≤k≤ for each valid ii the edge vivivivi exists in the graph  for each valid ii and j≤i−j≤i− the edge vivjvivj does not exist in the graph  for each valid ii if ii lets consider the graph without the edge vi−vivi−vi otherwise consider the original graph  in this graph the weight of the edge vivivivi is the minimum of weights of all edges adjacent to vivi   a graph is kkvertexcolourable if is possible to paint its vertices using at most kk distinct colours in such a way that no edge connects two vertices with the same colour  your task is to make the graph kkvertexcolourable by hitting the vertices  when a vertex uu is hit all the edges on the vibrating path with maximum length that starts at uu are removed note that this path is unique  you may hit vertices any number of times and in any order  however each time you hit a vertex at least one edge must be removed  for each valid ii the cost of hitting the iith vertex is cici  you should make the graph kkvertexcolourable and find one valid way to paint its vertices using kk colours numbered  through kk  if there are multiple solutions you may find any one  then the sum of costs of all hits you perform should be as small as possible  input  the first line of the input contains three spaceseparated integers nn mm and kk  the second line contains nn spaceseparated integers cc…cncc…cn  mm lines follow  for each valid ii the iith of these lines contains three spaceseparated integers uiui vivi and sisi   output print three lines   the first of these lines should contain a single integer qq ― the number of hits you want to perform  the second line should contain qq spaceseparated integers ― the vertices you want to hit in order  the third line should contain nn spaceseparated integers xx…xnxx…xn denoting that for each valid ii the iith vertex should have the colour xixi ≤xi≤k≤xi≤k   example input                                           example output              explanation the following picture describes the graph in the first hit the edge  is removed  in the second hit the edges on the path  are removed  in the third hit the edges on the path  are removed   test generation and constraints  nn is either  or  mm kk is either    or   there are eight test files one for each combination of nn mm and kk  for each test file  the costs cc…cncc…cn are chosen uniformly randomly and independently between  and  inclusive  mm distinct undirected edges are chosen uniformly randomly and independently from the n⋅n−n⋅n− possibilities  ss…smss…sm is a uniformly randomly chosen permutation of the integers  through mm   scoring if you perform a hit where no edge is removed or if there is an edge connecting two vertices with the same colour after performing all hits you will receive the wrong answer verdict  otherwise the score of a test file is the sum of costs of all hits you perform  the score of a submission is the sum of scores of all test files  your goal is to minimise the score of your submission  there are  test files  during the contest the displayed score will account for exactly  test files i e  your score reflects your submissions performance on  of the test files  however if your program gets a nonac verdict on any test file your submissions verdict will be nonac  in other words an ac verdict denotes that your program runs successfully on all the test files  after the end of the contest your score will be changed to include the sum of your programs scores over the other  test files   author ★alei editorial  codechef comproblemsvbr tags                                   alei alei challengeproblem graphcoloring graphs sept                                                                                        difficulty rating                        date added  time limit  secs source limit  bytes languages cpp pyth   java c cpp pyth pyp cs ada pypy text pas fpc nodejs ruby php go hask tcl kotlin perl scala lua bash js rust lisp sbcl pas gpc bf cloj r d caml swift fort asm fs wspc lisp clisp sql scm guile perl erl clps prlg sqlq ick nice icon cob scm chicken pike scm qobi st nem  submit