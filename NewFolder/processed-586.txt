 read problems statements in mandarin chinese russian and vietnamese as well  paavini nupur anchal and ishita are four best friends and roommates  in their normal routine they only study and study and do nothing else  but now that exams are over they want to explore the town so they went to the trade fair to eat  the trade fair has n halls and its represented by a tree with n vertices and n edges  each edge contains exactly one restaurant offering only meals of one type at a fixed cost  since bhavya and kaushal didnt go along with them they have asked q queries  each query is given as follows the friends move from hall u to hall v along the shortest path  from each restaurant they encounter on this path they will purchase exactly one meal in total if its cost c satisfies the following conditions  if c is a multiple of  c must be between x and y inclusive  if c is a multiple of  c must be between x and y inclusive  if c is a multiple of  c must be between x and y inclusive  c must be a multiple of   or   for each query compute the total cost of all meals bought when travelling from u to v  you have the answer the queries in online mode  input  the first line of the input contains two spaceseparated integers n and q denoting the number of halls and the number of queries respectively  each of the following n lines contains three spaceseparated integers u v and c denoting an edge connecting halls u and v and containing a restaurant which provides a meal with cost c  each of the following q lines contains eight spaceseparated integers in in in in in in in and in describing one query  lets define last as the answer of the previous query modulo  if it was the first query then last   the parameters of the query can be calculated by  u  in  last v  in  last x  in  last y  in  last x  in  last y  in  last x  in  last y  in  last output for each query print the answer to it on a separate line  constraints   ≤ n q ≤   ≤ u v ≤ n  ≤ c ≤   ≤ xi ≤ y i ≤  for each  ≤ i ≤   subtasks subtask   points  ≤ n q ≤  subtask   points original constraints                          sample input                                                                             sample output                              explanation for the first query they will eat at the restaurant connecting halls  and  the cost of the meal there is   for the second query  is a multiple of  but according to the second condition the cost of this meal isnt between  and   hence they will not eat at any restaurant   author ★abx tester ★kingofnumbers editorial  codechef comproblemsabx tags                                   trees square root decomposition inclusion exclusion principle lowest common ancestor dfs binary search online queries                                                              data structures graphs advanced algorithms mathematics set theory algorithms graph algos traversals searching queries                                                                                        difficulty rating                        date added  time limit  secs source limit  bytes languages pyth   java c cpp pyth pyp cs ada pypy text pas fpc nodejs ruby php go hask tcl kotlin perl scala lua bash js rust lisp sbcl pas gpc bf cloj d caml swift fort asm fs wspc lisp clisp scm guile perl erl clps prlg ick nice icon cob scm chicken pike scm qobi st nem  submit