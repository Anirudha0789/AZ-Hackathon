  malvika is the leader of a large tribal army with soldiers from multiple tribes  there are a total of n soldiers in the army  you are given an array a of length n where ai denotes the tribe number of the ith soldier  now animesh the leader of the neighboring tribe and staunch enemy of malvika has attacked her army and declared a war which would later be regarded as the greatest tribal war of the contemporary world  for this soontobelengendry war malvika wanted to evaluate the strength of her army  malvikas armys strength is based on love i e  the pairwise strength of two people from the different tribes would be zero while for those from the same tribe it will be the distance between their positions in the line  the more the distance the lonelier they feel  the lonelier they feel the more they love each other  as their love grows so does the strength of the army  formally strength of an army denoted by an array a will be the sum of pairwise strengths of each pair of people from the same tribe i e  sum of all i  j for  ≤ i ≤ j ≤ n such that ai  aj  malvika wants to rearrange her army to maximize the strength  let m denote the maximum strength of her army after rearranging the soldiers   you have to help her find out the number of rearrangements of her army having the maximum strength  the more the rearrangements are there are more chances of her winning the battle  as they say you can win the battle with a lot of strength but you need rearrangements of that strength to win the war  since the battle is expected to be long drawn the answer could be very large  so print your answer modulo     two arrangements of the army — a and b — are said to be distinct if there is an index i from  to n such that ai ≠ bi  that is if some position in the army is occupied by soldiers from different tribes in the two arrangements   input  the first line of input contains a single integer t denoting the number of test cases  the first line of each test case contains a single integer n as defined in the statement  the second line of each test case will contain n space separated integers denoting the array a   output  for each test case output a single integer in a line corresponding to the answer of the problem   constraints   ≤ t ≤   ≤ n ≤   ≤ ai ≤   example input               output     explanation in the first example the strength of the army is zero irrespective of the way she arranges her army  there are two ways of arranging the army namely   and     in the second example she can arrange a maximum strength army in four ways  those are                  strength of her army in all the four cases will be  the maximum possible strength of the army that she can get    author admin tags                                   frequency arrays hashmaps combinatorics sorting                                                              data structures arrays mathematics algorithms                                                                                        difficulty rating                       na date added  time limit  secs source limit  bytes languages java c cpp pyp  submit